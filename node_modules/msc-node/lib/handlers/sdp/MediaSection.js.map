{"version":3,"file":"MediaSection.js","sourceRoot":"","sources":["../../../src/handlers/sdp/MediaSection.ts"],"names":[],"mappings":"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","sourcesContent":["import * as utils from '../../utils';\nimport {\n\tIceParameters,\n\tIceCandidate,\n\tDtlsParameters,\n\tDtlsRole,\n\tPlainRtpParameters\n} from '../../Transport';\nimport { ProducerCodecOptions } from '../../Producer';\nimport {\n\tMediaKind,\n\tRtpParameters,\n\tRtpCodecParameters,\n\tRtpHeaderExtensionParameters\n} from '../../RtpParameters';\nimport { SctpParameters } from '../../SctpParameters';\n\nexport abstract class MediaSection\n{\n\t// SDP media object.\n\tprotected readonly _mediaObject: any;\n\t// Whether this is Plan-B SDP.\n\tprotected readonly _planB: boolean;\n\n\tconstructor(\n\t\t{\n\t\t\ticeParameters,\n\t\t\ticeCandidates,\n\t\t\tdtlsParameters,\n\t\t\tplanB = false\n\t\t}:\n\t\t{\n\t\t\ticeParameters?: IceParameters;\n\t\t\ticeCandidates?: IceCandidate[];\n\t\t\tdtlsParameters?: DtlsParameters;\n\t\t\tplanB: boolean;\n\t\t}\n\t)\n\t{\n\t\tthis._mediaObject = {};\n\t\tthis._planB = planB;\n\n\t\tif (iceParameters)\n\t\t{\n\t\t\tthis.setIceParameters(iceParameters);\n\t\t}\n\n\t\tif (iceCandidates)\n\t\t{\n\t\t\tthis._mediaObject.candidates = [];\n\n\t\t\tfor (const candidate of iceCandidates)\n\t\t\t{\n\t\t\t\tconst candidateObject: any = {};\n\n\t\t\t\t// mediasoup does mandates rtcp-mux so candidates component is always\n\t\t\t\t// RTP (1).\n\t\t\t\tcandidateObject.component = 1;\n\t\t\t\tcandidateObject.foundation = candidate.foundation;\n\t\t\t\tcandidateObject.ip = candidate.ip;\n\t\t\t\tcandidateObject.port = candidate.port;\n\t\t\t\tcandidateObject.priority = candidate.priority;\n\t\t\t\tcandidateObject.transport = candidate.protocol;\n\t\t\t\tcandidateObject.type = candidate.type;\n\t\t\t\tif (candidate.tcpType)\n\t\t\t\t\tcandidateObject.tcptype = candidate.tcpType;\n\n\t\t\t\tthis._mediaObject.candidates.push(candidateObject);\n\t\t\t}\n\n\t\t\tthis._mediaObject.endOfCandidates = 'end-of-candidates';\n\t\t\tthis._mediaObject.iceOptions = 'renomination';\n\t\t}\n\n\t\tif (dtlsParameters)\n\t\t{\n\t\t\tthis.setDtlsRole(dtlsParameters.role!);\n\t\t}\n\t}\n\n\tabstract setDtlsRole(role: DtlsRole): void;\n\n\tget mid(): string\n\t{\n\t\treturn String(this._mediaObject.mid);\n\t}\n\n\tget closed(): boolean\n\t{\n\t\treturn this._mediaObject.port === 0;\n\t}\n\n\tgetObject(): object\n\t{\n\t\treturn this._mediaObject;\n\t}\n\n\tsetIceParameters(iceParameters: IceParameters): void\n\t{\n\t\tthis._mediaObject.iceUfrag = iceParameters.usernameFragment;\n\t\tthis._mediaObject.icePwd = iceParameters.password;\n\t}\n\n\tdisable(): void\n\t{\n\t\tthis._mediaObject.direction = 'inactive';\n\n\t\tdelete this._mediaObject.ext;\n\t\tdelete this._mediaObject.ssrcs;\n\t\tdelete this._mediaObject.ssrcGroups;\n\t\tdelete this._mediaObject.simulcast;\n\t\tdelete this._mediaObject.simulcast_03;\n\t\tdelete this._mediaObject.rids;\n\t}\n\n\tclose(): void\n\t{\n\t\tthis._mediaObject.direction = 'inactive';\n\n\t\tthis._mediaObject.port = 0;\n\n\t\tdelete this._mediaObject.ext;\n\t\tdelete this._mediaObject.ssrcs;\n\t\tdelete this._mediaObject.ssrcGroups;\n\t\tdelete this._mediaObject.simulcast;\n\t\tdelete this._mediaObject.simulcast_03;\n\t\tdelete this._mediaObject.rids;\n\t\tdelete this._mediaObject.extmapAllowMixed;\n\t}\n}\n\nexport class AnswerMediaSection extends MediaSection\n{\n\tconstructor(\n\t\t{\n\t\t\ticeParameters,\n\t\t\ticeCandidates,\n\t\t\tdtlsParameters,\n\t\t\tsctpParameters,\n\t\t\tplainRtpParameters,\n\t\t\tplanB = false,\n\t\t\tofferMediaObject,\n\t\t\tofferRtpParameters,\n\t\t\tanswerRtpParameters,\n\t\t\tcodecOptions,\n\t\t\textmapAllowMixed = false\n\t\t}:\n\t\t{\n\t\t\ticeParameters?: IceParameters;\n\t\t\ticeCandidates?: IceCandidate[];\n\t\t\tdtlsParameters?: DtlsParameters;\n\t\t\tsctpParameters?: SctpParameters;\n\t\t\tplainRtpParameters?: PlainRtpParameters;\n\t\t\tplanB?: boolean;\n\t\t\tofferMediaObject: any;\n\t\t\tofferRtpParameters?: RtpParameters;\n\t\t\tanswerRtpParameters?: RtpParameters;\n\t\t\tcodecOptions?: ProducerCodecOptions;\n\t\t\textmapAllowMixed?: boolean;\n\t\t}\n\t)\n\t{\n\t\tsuper({ iceParameters, iceCandidates, dtlsParameters, planB });\n\n\t\tthis._mediaObject.mid = String(offerMediaObject.mid);\n\t\tthis._mediaObject.type = offerMediaObject.type;\n\t\tthis._mediaObject.protocol = offerMediaObject.protocol;\n\n\t\tif (!plainRtpParameters)\n\t\t{\n\t\t\tthis._mediaObject.connection = { ip: '127.0.0.1', version: 4 };\n\t\t\tthis._mediaObject.port = 7;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._mediaObject.connection =\n\t\t\t{\n\t\t\t\tip      : plainRtpParameters.ip,\n\t\t\t\tversion : plainRtpParameters.ipVersion\n\t\t\t};\n\t\t\tthis._mediaObject.port = plainRtpParameters.port;\n\t\t}\n\n\t\tswitch (offerMediaObject.type)\n\t\t{\n\t\t\tcase 'audio':\n\t\t\tcase 'video':\n\t\t\t{\n\t\t\t\tthis._mediaObject.direction = 'recvonly';\n\t\t\t\tthis._mediaObject.rtp = [];\n\t\t\t\tthis._mediaObject.rtcpFb = [];\n\t\t\t\tthis._mediaObject.fmtp = [];\n\n\t\t\t\tfor (const codec of answerRtpParameters!.codecs)\n\t\t\t\t{\n\t\t\t\t\tconst rtp: any =\n\t\t\t\t\t{\n\t\t\t\t\t\tpayload : codec.payloadType,\n\t\t\t\t\t\tcodec   : getCodecName(codec),\n\t\t\t\t\t\trate    : codec.clockRate\n\t\t\t\t\t};\n\n\t\t\t\t\tif (codec.channels! > 1)\n\t\t\t\t\t\trtp.encoding = codec.channels;\n\n\t\t\t\t\tthis._mediaObject.rtp.push(rtp);\n\n\t\t\t\t\tconst codecParameters = utils.clone(codec.parameters, {});\n\n\t\t\t\t\tif (codecOptions)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst {\n\t\t\t\t\t\t\topusStereo,\n\t\t\t\t\t\t\topusFec,\n\t\t\t\t\t\t\topusDtx,\n\t\t\t\t\t\t\topusMaxPlaybackRate,\n\t\t\t\t\t\t\topusMaxAverageBitrate,\n\t\t\t\t\t\t\topusPtime,\n\t\t\t\t\t\t\tvideoGoogleStartBitrate,\n\t\t\t\t\t\t\tvideoGoogleMaxBitrate,\n\t\t\t\t\t\t\tvideoGoogleMinBitrate\n\t\t\t\t\t\t} = codecOptions;\n\n\t\t\t\t\t\tconst offerCodec = offerRtpParameters!.codecs\n\t\t\t\t\t\t\t.find((c: RtpCodecParameters) => (\n\t\t\t\t\t\t\t\tc.payloadType === codec.payloadType\n\t\t\t\t\t\t\t));\n\n\t\t\t\t\t\tswitch (codec.mimeType.toLowerCase())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcase 'audio/opus':\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (opusStereo !== undefined)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tofferCodec!.parameters['sprop-stereo'] = opusStereo ? 1 : 0;\n\t\t\t\t\t\t\t\t\tcodecParameters.stereo = opusStereo ? 1 : 0;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (opusFec !== undefined)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tofferCodec!.parameters.useinbandfec = opusFec ? 1 : 0;\n\t\t\t\t\t\t\t\t\tcodecParameters.useinbandfec = opusFec ? 1 : 0;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (opusDtx !== undefined)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tofferCodec!.parameters.usedtx = opusDtx ? 1 : 0;\n\t\t\t\t\t\t\t\t\tcodecParameters.usedtx = opusDtx ? 1 : 0;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (opusMaxPlaybackRate !== undefined)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcodecParameters.maxplaybackrate = opusMaxPlaybackRate;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (opusMaxAverageBitrate !== undefined)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcodecParameters.maxaveragebitrate = opusMaxAverageBitrate;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (opusPtime !== undefined)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tofferCodec!.parameters.ptime = opusPtime;\n\t\t\t\t\t\t\t\t\tcodecParameters.ptime = opusPtime;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tcase 'video/vp8':\n\t\t\t\t\t\t\tcase 'video/vp9':\n\t\t\t\t\t\t\tcase 'video/h264':\n\t\t\t\t\t\t\tcase 'video/h265':\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (videoGoogleStartBitrate !== undefined)\n\t\t\t\t\t\t\t\t\tcodecParameters['x-google-start-bitrate'] = videoGoogleStartBitrate;\n\n\t\t\t\t\t\t\t\tif (videoGoogleMaxBitrate !== undefined)\n\t\t\t\t\t\t\t\t\tcodecParameters['x-google-max-bitrate'] = videoGoogleMaxBitrate;\n\n\t\t\t\t\t\t\t\tif (videoGoogleMinBitrate !== undefined)\n\t\t\t\t\t\t\t\t\tcodecParameters['x-google-min-bitrate'] = videoGoogleMinBitrate;\n\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tconst fmtp =\n\t\t\t\t\t{\n\t\t\t\t\t\tpayload : codec.payloadType,\n\t\t\t\t\t\tconfig  : ''\n\t\t\t\t\t};\n\n\t\t\t\t\tfor (const key of Object.keys(codecParameters))\n\t\t\t\t\t{\n\t\t\t\t\t\tif (fmtp.config)\n\t\t\t\t\t\t\tfmtp.config += ';';\n\n\t\t\t\t\t\tfmtp.config += `${key}=${codecParameters[key]}`;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (fmtp.config)\n\t\t\t\t\t\tthis._mediaObject.fmtp.push(fmtp);\n\n\t\t\t\t\tfor (const fb of codec.rtcpFeedback!)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._mediaObject.rtcpFb.push(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tpayload : codec.payloadType,\n\t\t\t\t\t\t\t\ttype    : fb.type,\n\t\t\t\t\t\t\t\tsubtype : fb.parameter\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._mediaObject.payloads = answerRtpParameters!.codecs\n\t\t\t\t\t.map((codec: RtpCodecParameters) => codec.payloadType)\n\t\t\t\t\t.join(' ');\n\n\t\t\t\tthis._mediaObject.ext = [];\n\n\t\t\t\tfor (const ext of answerRtpParameters!.headerExtensions!)\n\t\t\t\t{\n\t\t\t\t\t// Don't add a header extension if not present in the offer.\n\t\t\t\t\tconst found = (offerMediaObject.ext || [])\n\t\t\t\t\t\t.some((localExt: RtpHeaderExtensionParameters) => localExt.uri === ext.uri);\n\n\t\t\t\t\tif (!found)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tthis._mediaObject.ext.push(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\turi   : ext.uri,\n\t\t\t\t\t\t\tvalue : ext.id\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// Allow both 1 byte and 2 bytes length header extensions.\n\t\t\t\tif (\n\t\t\t\t\textmapAllowMixed &&\n\t\t\t\t\tofferMediaObject.extmapAllowMixed === 'extmap-allow-mixed'\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tthis._mediaObject.extmapAllowMixed = 'extmap-allow-mixed';\n\t\t\t\t}\n\n\t\t\t\t// Simulcast.\n\t\t\t\tif (offerMediaObject.simulcast)\n\t\t\t\t{\n\t\t\t\t\tthis._mediaObject.simulcast =\n\t\t\t\t\t{\n\t\t\t\t\t\tdir1  : 'recv',\n\t\t\t\t\t\tlist1 : offerMediaObject.simulcast.list1\n\t\t\t\t\t};\n\n\t\t\t\t\tthis._mediaObject.rids = [];\n\n\t\t\t\t\tfor (const rid of offerMediaObject.rids || [])\n\t\t\t\t\t{\n\t\t\t\t\t\tif (rid.direction !== 'send')\n\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\tthis._mediaObject.rids.push(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid        : rid.id,\n\t\t\t\t\t\t\t\tdirection : 'recv'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Simulcast (draft version 03).\n\t\t\t\telse if (offerMediaObject.simulcast_03)\n\t\t\t\t{\n\t\t\t\t\t// eslint-disable-next-line camelcase\n\t\t\t\t\tthis._mediaObject.simulcast_03 =\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue : offerMediaObject.simulcast_03.value.replace(/send/g, 'recv')\n\t\t\t\t\t};\n\n\t\t\t\t\tthis._mediaObject.rids = [];\n\n\t\t\t\t\tfor (const rid of offerMediaObject.rids || [])\n\t\t\t\t\t{\n\t\t\t\t\t\tif (rid.direction !== 'send')\n\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\tthis._mediaObject.rids.push(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid        : rid.id,\n\t\t\t\t\t\t\t\tdirection : 'recv'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._mediaObject.rtcpMux = 'rtcp-mux';\n\t\t\t\tthis._mediaObject.rtcpRsize = 'rtcp-rsize';\n\n\t\t\t\tif (this._planB && this._mediaObject.type === 'video')\n\t\t\t\t\tthis._mediaObject.xGoogleFlag = 'conference';\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'application':\n\t\t\t{\n\t\t\t\t// New spec.\n\t\t\t\tif (typeof offerMediaObject.sctpPort === 'number')\n\t\t\t\t{\n\t\t\t\t\tthis._mediaObject.payloads = 'webrtc-datachannel';\n\t\t\t\t\tthis._mediaObject.sctpPort = sctpParameters!.port;\n\t\t\t\t\tthis._mediaObject.maxMessageSize = sctpParameters!.maxMessageSize;\n\t\t\t\t}\n\t\t\t\t// Old spec.\n\t\t\t\telse if (offerMediaObject.sctpmap)\n\t\t\t\t{\n\t\t\t\t\tthis._mediaObject.payloads = sctpParameters!.port;\n\t\t\t\t\tthis._mediaObject.sctpmap =\n\t\t\t\t\t{\n\t\t\t\t\t\tapp            : 'webrtc-datachannel',\n\t\t\t\t\t\tsctpmapNumber  : sctpParameters!.port,\n\t\t\t\t\t\tmaxMessageSize : sctpParameters!.maxMessageSize\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tsetDtlsRole(role: DtlsRole): void\n\t{\n\t\tswitch (role)\n\t\t{\n\t\t\tcase 'client':\n\t\t\t\tthis._mediaObject.setup = 'active';\n\t\t\t\tbreak;\n\t\t\tcase 'server':\n\t\t\t\tthis._mediaObject.setup = 'passive';\n\t\t\t\tbreak;\n\t\t\tcase 'auto':\n\t\t\t\tthis._mediaObject.setup = 'actpass';\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n\nexport class OfferMediaSection extends MediaSection\n{\n\tconstructor(\n\t\t{\n\t\t\ticeParameters,\n\t\t\ticeCandidates,\n\t\t\tdtlsParameters,\n\t\t\tsctpParameters,\n\t\t\tplainRtpParameters,\n\t\t\tplanB = false,\n\t\t\tmid,\n\t\t\tkind,\n\t\t\tofferRtpParameters,\n\t\t\tstreamId,\n\t\t\ttrackId,\n\t\t\toldDataChannelSpec = false\n\t\t}:\n\t\t{\n\t\t\ticeParameters?: IceParameters;\n\t\t\ticeCandidates?: IceCandidate[];\n\t\t\tdtlsParameters?: DtlsParameters;\n\t\t\tsctpParameters?: SctpParameters;\n\t\t\tplainRtpParameters?: PlainRtpParameters;\n\t\t\tplanB?: boolean;\n\t\t\tmid: string;\n\t\t\tkind: MediaKind | 'application';\n\t\t\tofferRtpParameters?: RtpParameters;\n\t\t\tstreamId?: string;\n\t\t\ttrackId?: string;\n\t\t\toldDataChannelSpec?: boolean;\n\t\t}\n\t)\n\t{\n\t\tsuper({ iceParameters, iceCandidates, dtlsParameters, planB });\n\n\t\tthis._mediaObject.mid = String(mid);\n\t\tthis._mediaObject.type = kind;\n\n\t\tif (!plainRtpParameters)\n\t\t{\n\t\t\tthis._mediaObject.connection = { ip: '127.0.0.1', version: 4 };\n\n\t\t\tif (!sctpParameters)\n\t\t\t\tthis._mediaObject.protocol = 'UDP/TLS/RTP/SAVPF';\n\t\t\telse\n\t\t\t\tthis._mediaObject.protocol = 'UDP/DTLS/SCTP';\n\n\t\t\tthis._mediaObject.port = 7;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._mediaObject.connection =\n\t\t\t{\n\t\t\t\tip      : plainRtpParameters.ip,\n\t\t\t\tversion : plainRtpParameters.ipVersion\n\t\t\t};\n\t\t\tthis._mediaObject.protocol = 'RTP/AVP';\n\t\t\tthis._mediaObject.port = plainRtpParameters.port;\n\t\t}\n\n\t\tswitch (kind)\n\t\t{\n\t\t\tcase 'audio':\n\t\t\tcase 'video':\n\t\t\t{\n\t\t\t\tthis._mediaObject.direction = 'sendonly';\n\t\t\t\tthis._mediaObject.rtp = [];\n\t\t\t\tthis._mediaObject.rtcpFb = [];\n\t\t\t\tthis._mediaObject.fmtp = [];\n\n\t\t\t\tif (!this._planB)\n\t\t\t\t\tthis._mediaObject.msid = `${streamId || '-'} ${trackId}`;\n\n\t\t\t\tfor (const codec of offerRtpParameters!.codecs)\n\t\t\t\t{\n\t\t\t\t\tconst rtp: any =\n\t\t\t\t\t{\n\t\t\t\t\t\tpayload : codec.payloadType,\n\t\t\t\t\t\tcodec   : getCodecName(codec),\n\t\t\t\t\t\trate    : codec.clockRate\n\t\t\t\t\t};\n\n\t\t\t\t\tif (codec.channels! > 1)\n\t\t\t\t\t\trtp.encoding = codec.channels;\n\n\t\t\t\t\tthis._mediaObject.rtp.push(rtp);\n\n\t\t\t\t\tconst fmtp =\n\t\t\t\t\t{\n\t\t\t\t\t\tpayload : codec.payloadType,\n\t\t\t\t\t\tconfig  : ''\n\t\t\t\t\t};\n\n\t\t\t\t\tfor (const key of Object.keys(codec.parameters))\n\t\t\t\t\t{\n\t\t\t\t\t\tif (fmtp.config)\n\t\t\t\t\t\t\tfmtp.config += ';';\n\n\t\t\t\t\t\tfmtp.config += `${key}=${codec.parameters[key]}`;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (fmtp.config)\n\t\t\t\t\t\tthis._mediaObject.fmtp.push(fmtp);\n\n\t\t\t\t\tfor (const fb of codec.rtcpFeedback!)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._mediaObject.rtcpFb.push(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tpayload : codec.payloadType,\n\t\t\t\t\t\t\t\ttype    : fb.type,\n\t\t\t\t\t\t\t\tsubtype : fb.parameter\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._mediaObject.payloads = offerRtpParameters!.codecs\n\t\t\t\t\t.map((codec: RtpCodecParameters) => codec.payloadType)\n\t\t\t\t\t.join(' ');\n\n\t\t\t\tthis._mediaObject.ext = [];\n\n\t\t\t\tfor (const ext of offerRtpParameters!.headerExtensions!)\n\t\t\t\t{\n\t\t\t\t\tthis._mediaObject.ext.push(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\turi   : ext.uri,\n\t\t\t\t\t\t\tvalue : ext.id\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis._mediaObject.rtcpMux = 'rtcp-mux';\n\t\t\t\tthis._mediaObject.rtcpRsize = 'rtcp-rsize';\n\n\t\t\t\tconst encoding = offerRtpParameters!.encodings![0];\n\t\t\t\tconst ssrc = encoding.ssrc;\n\t\t\t\tconst rtxSsrc = (encoding.rtx && encoding.rtx.ssrc)\n\t\t\t\t\t? encoding.rtx.ssrc\n\t\t\t\t\t: undefined;\n\n\t\t\t\tthis._mediaObject.ssrcs = [];\n\t\t\t\tthis._mediaObject.ssrcGroups = [];\n\n\t\t\t\tif (offerRtpParameters!.rtcp!.cname)\n\t\t\t\t{\n\t\t\t\t\tthis._mediaObject.ssrcs.push(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid        : ssrc,\n\t\t\t\t\t\t\tattribute : 'cname',\n\t\t\t\t\t\t\tvalue     : offerRtpParameters!.rtcp!.cname\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (this._planB)\n\t\t\t\t{\n\t\t\t\t\tthis._mediaObject.ssrcs.push(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid        : ssrc,\n\t\t\t\t\t\t\tattribute : 'msid',\n\t\t\t\t\t\t\tvalue     : `${streamId || '-'} ${trackId}`\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (rtxSsrc)\n\t\t\t\t{\n\t\t\t\t\tif (offerRtpParameters!.rtcp!.cname)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._mediaObject.ssrcs.push(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid        : rtxSsrc,\n\t\t\t\t\t\t\t\tattribute : 'cname',\n\t\t\t\t\t\t\t\tvalue     : offerRtpParameters!.rtcp!.cname\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this._planB)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._mediaObject.ssrcs.push(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid        : rtxSsrc,\n\t\t\t\t\t\t\t\tattribute : 'msid',\n\t\t\t\t\t\t\t\tvalue     : `${streamId || '-'} ${trackId}`\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// Associate original and retransmission SSRCs.\n\t\t\t\t\tthis._mediaObject.ssrcGroups.push(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsemantics : 'FID',\n\t\t\t\t\t\t\tssrcs     : `${ssrc} ${rtxSsrc}`\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'application':\n\t\t\t{\n\t\t\t\t// New spec.\n\t\t\t\tif (!oldDataChannelSpec)\n\t\t\t\t{\n\t\t\t\t\tthis._mediaObject.payloads = 'webrtc-datachannel';\n\t\t\t\t\tthis._mediaObject.sctpPort = sctpParameters!.port;\n\t\t\t\t\tthis._mediaObject.maxMessageSize = sctpParameters!.maxMessageSize;\n\t\t\t\t}\n\t\t\t\t// Old spec.\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._mediaObject.payloads = sctpParameters!.port;\n\t\t\t\t\tthis._mediaObject.sctpmap =\n\t\t\t\t\t{\n\t\t\t\t\t\tapp            : 'webrtc-datachannel',\n\t\t\t\t\t\tsctpmapNumber  : sctpParameters!.port,\n\t\t\t\t\t\tmaxMessageSize : sctpParameters!.maxMessageSize\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\tsetDtlsRole(role: DtlsRole): void\n\t{\n\t\t// Always 'actpass'.\n\t\tthis._mediaObject.setup = 'actpass';\n\t}\n\n\tplanBReceive(\n\t\t{\n\t\t\tofferRtpParameters,\n\t\t\tstreamId,\n\t\t\ttrackId\n\t\t}:\n\t\t{\n\t\t\tofferRtpParameters: RtpParameters;\n\t\t\tstreamId: string;\n\t\t\ttrackId: string;\n\t\t}\n\t): void\n\t{\n\t\tconst encoding = offerRtpParameters.encodings![0];\n\t\tconst ssrc = encoding.ssrc;\n\t\tconst rtxSsrc = (encoding.rtx && encoding.rtx.ssrc)\n\t\t\t? encoding.rtx.ssrc\n\t\t\t: undefined;\n\n\t\tif (offerRtpParameters.rtcp!.cname)\n\t\t{\n\t\t\tthis._mediaObject.ssrcs.push(\n\t\t\t\t{\n\t\t\t\t\tid        : ssrc,\n\t\t\t\t\tattribute : 'cname',\n\t\t\t\t\tvalue     : offerRtpParameters.rtcp!.cname\n\t\t\t\t});\n\t\t}\n\n\t\tthis._mediaObject.ssrcs.push(\n\t\t\t{\n\t\t\t\tid        : ssrc,\n\t\t\t\tattribute : 'msid',\n\t\t\t\tvalue     : `${streamId || '-'} ${trackId}`\n\t\t\t});\n\n\t\tif (rtxSsrc)\n\t\t{\n\t\t\tif (offerRtpParameters.rtcp!.cname)\n\t\t\t{\n\t\t\t\tthis._mediaObject.ssrcs.push(\n\t\t\t\t\t{\n\t\t\t\t\t\tid        : rtxSsrc,\n\t\t\t\t\t\tattribute : 'cname',\n\t\t\t\t\t\tvalue     : offerRtpParameters.rtcp!.cname\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis._mediaObject.ssrcs.push(\n\t\t\t\t{\n\t\t\t\t\tid        : rtxSsrc,\n\t\t\t\t\tattribute : 'msid',\n\t\t\t\t\tvalue     : `${streamId || '-'} ${trackId}`\n\t\t\t\t});\n\n\t\t\t// Associate original and retransmission SSRCs.\n\t\t\tthis._mediaObject.ssrcGroups.push(\n\t\t\t\t{\n\t\t\t\t\tsemantics : 'FID',\n\t\t\t\t\tssrcs     : `${ssrc} ${rtxSsrc}`\n\t\t\t\t});\n\t\t}\n\t}\n\n\tplanBStopReceiving(\n\t\t{ offerRtpParameters }: { offerRtpParameters: RtpParameters }\n\t): void\n\t{\n\t\tconst encoding = offerRtpParameters.encodings![0];\n\t\tconst ssrc = encoding.ssrc;\n\t\tconst rtxSsrc = (encoding.rtx && encoding.rtx.ssrc)\n\t\t\t? encoding.rtx.ssrc\n\t\t\t: undefined;\n\n\t\tthis._mediaObject.ssrcs = this._mediaObject.ssrcs\n\t\t\t.filter((s: any) => s.id !== ssrc && s.id !== rtxSsrc);\n\n\t\tif (rtxSsrc)\n\t\t{\n\t\t\tthis._mediaObject.ssrcGroups = this._mediaObject.ssrcGroups\n\t\t\t\t.filter((group: any) => group.ssrcs !== `${ssrc} ${rtxSsrc}`);\n\t\t}\n\t}\n}\n\nfunction getCodecName(codec: RtpCodecParameters): string\n{\n\tconst MimeTypeRegex = new RegExp('^(audio|video)/(.+)', 'i');\n\tconst mimeTypeMatch = MimeTypeRegex.exec(codec.mimeType);\n\n\tif (!mimeTypeMatch)\n\t\tthrow new TypeError('invalid codec.mimeType');\n\n\treturn mimeTypeMatch[2];\n}\n"]}