{"version":3,"file":"srtp.js","sourceRoot":"","sources":["../../../../../../rtp/src/srtp/context/srtp.ts"],"names":[],"mappings":";;;AAAA,uCAA0C;AAE1C,uCAAoC;AAEpC,MAAa,WAAY,SAAQ,iBAAO;IACtC,YAAY,SAAiB,EAAE,UAAkB,EAAE,OAAgB;QACjE,KAAK,CAAC,SAAS,EAAE,UAAU,EAAE,OAAO,CAAC,CAAC;IACxC,CAAC;IAED,UAAU,CAAC,OAAe,EAAE,MAAiB;QAC3C,MAAM,CAAC,GAAG,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAC7C,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC;QAEnD,MAAM,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,MAAM,EAAE,OAAO,EAAE,CAAC,CAAC,eAAe,CAAC,CAAC;QACvE,OAAO,GAAG,CAAC;IACb,CAAC;IAED,UAAU,CAAC,UAAkB;QAC3B,MAAM,MAAM,GAAG,eAAS,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;QAEjD,MAAM,CAAC,GAAG,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAC7C,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC;QAEnD,MAAM,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,UAAU,EAAE,CAAC,CAAC,eAAe,CAAC,CAAC;QAClE,OAAO,GAAG,CAAC;IACb,CAAC;CACF;AAtBD,kCAsBC","sourcesContent":["import { RtpHeader } from \"../../rtp/rtp\";\nimport { Profile } from \"../const\";\nimport { Context } from \"./context\";\n\nexport class SrtpContext extends Context {\n  constructor(masterKey: Buffer, masterSalt: Buffer, profile: Profile) {\n    super(masterKey, masterSalt, profile);\n  }\n\n  encryptRtp(payload: Buffer, header: RtpHeader) {\n    const s = this.getSrtpSsrcState(header.ssrc);\n    this.updateRolloverCount(header.sequenceNumber, s);\n\n    const enc = this.cipher.encryptRtp(header, payload, s.rolloverCounter);\n    return enc;\n  }\n\n  decryptRtp(cipherText: Buffer): [Buffer, RtpHeader] {\n    const header = RtpHeader.deSerialize(cipherText);\n\n    const s = this.getSrtpSsrcState(header.ssrc);\n    this.updateRolloverCount(header.sequenceNumber, s);\n\n    const dec = this.cipher.decryptRtp(cipherText, s.rolloverCounter);\n    return dec;\n  }\n}\n"]}