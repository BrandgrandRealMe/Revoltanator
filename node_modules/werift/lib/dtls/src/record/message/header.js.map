{"version":3,"file":"header.js","sourceRoot":"","sources":["../../../../../../dtls/src/record/message/header.ts"],"names":[],"mappings":";;;AAAA,6CAAoD;AAEpD,mDAAyD;AAEzD,MAAa,mBAAmB;IAS9B,YACS,WAAmB,EACnB,eAAiD,EACjD,KAAa,EACb,cAAsB,EACtB,UAAkB;QAJlB,gBAAW,GAAX,WAAW,CAAQ;QACnB,oBAAe,GAAf,eAAe,CAAkC;QACjD,UAAK,GAAL,KAAK,CAAQ;QACb,mBAAc,GAAd,cAAc,CAAQ;QACtB,eAAU,GAAV,UAAU,CAAQ;IACxB,CAAC;IAEJ,MAAM,CAAC,WAAW;QAChB,OAAO,IAAI,mBAAmB,CAC5B,SAAgB,EAChB,SAAgB,EAChB,SAAgB,EAChB,SAAgB,EAChB,SAAgB,CACjB,CAAC;IACJ,CAAC;IAED,MAAM,CAAC,WAAW,CAAC,GAAW;QAC5B,OAAO,IAAI,mBAAmB;QAC5B,YAAY;QACZ,GAAG,MAAM,CAAC,MAAM,CAAC,oBAAM,CAAC,GAAG,EAAE,mBAAmB,CAAC,IAAI,CAAC,CAAC,CACxD,CAAC;IACJ,CAAC;IAED,SAAS;QACP,MAAM,GAAG,GAAG,oBAAM,CAAC,IAAI,EAAE,mBAAmB,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,CAAC;QAC3D,OAAO,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IAC1B,CAAC;;AArCH,kDAsCC;AArCiB,wBAAI,GAAG;IACrB,WAAW,EAAE,mBAAK,CAAC,KAAK;IACxB,eAAe,EAAE,wBAAe;IAChC,KAAK,EAAE,mBAAK,CAAC,QAAQ;IACrB,cAAc,EAAE,mBAAK,CAAC,QAAQ;IAC9B,UAAU,EAAE,mBAAK,CAAC,QAAQ;CAC3B,CAAC;AAiCJ,MAAa,SAAS;IASpB,YACS,KAAa,EACb,cAAsB,EACtB,WAAmB,EACnB,eAAiD,EACjD,UAAkB;QAJlB,UAAK,GAAL,KAAK,CAAQ;QACb,mBAAc,GAAd,cAAc,CAAQ;QACtB,gBAAW,GAAX,WAAW,CAAQ;QACnB,oBAAe,GAAf,eAAe,CAAkC;QACjD,eAAU,GAAV,UAAU,CAAQ;IACxB,CAAC;IAEJ,MAAM,CAAC,WAAW;QAChB,OAAO,IAAI,SAAS,CAClB,SAAgB,EAChB,SAAgB,EAChB,SAAgB,EAChB,SAAgB,EAChB,SAAgB,CACjB,CAAC;IACJ,CAAC;IAED,MAAM,CAAC,WAAW,CAAC,GAAW;QAC5B,OAAO,IAAI,SAAS;QAClB,YAAY;QACZ,GAAG,MAAM,CAAC,MAAM,CAAC,oBAAM,CAAC,GAAG,EAAE,SAAS,CAAC,IAAI,CAAC,CAAC,CAC9C,CAAC;IACJ,CAAC;IAED,SAAS;QACP,MAAM,GAAG,GAAG,oBAAM,CAAC,IAAI,EAAE,SAAS,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,CAAC;QACjD,OAAO,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IAC1B,CAAC;;AArCH,8BAsCC;AArCiB,cAAI,GAAG;IACrB,KAAK,EAAE,mBAAK,CAAC,QAAQ;IACrB,cAAc,EAAE,mBAAK,CAAC,QAAQ;IAC9B,WAAW,EAAE,mBAAK,CAAC,KAAK;IACxB,eAAe,EAAE,wBAAe;IAChC,UAAU,EAAE,mBAAK,CAAC,QAAQ;CAC3B,CAAC","sourcesContent":["import { decode, encode, types } from \"binary-data\";\n\nimport { ProtocolVersion } from \"../../handshake/binary\";\n\nexport class DtlsPlaintextHeader {\n  static readonly spec = {\n    contentType: types.uint8,\n    protocolVersion: ProtocolVersion,\n    epoch: types.uint16be,\n    sequenceNumber: types.uint48be,\n    contentLen: types.uint16be,\n  };\n\n  constructor(\n    public contentType: number,\n    public protocolVersion: { major: number; minor: number },\n    public epoch: number,\n    public sequenceNumber: number,\n    public contentLen: number\n  ) {}\n\n  static createEmpty() {\n    return new DtlsPlaintextHeader(\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any\n    );\n  }\n\n  static deSerialize(buf: Buffer) {\n    return new DtlsPlaintextHeader(\n      //@ts-ignore\n      ...Object.values(decode(buf, DtlsPlaintextHeader.spec))\n    );\n  }\n\n  serialize() {\n    const res = encode(this, DtlsPlaintextHeader.spec).slice();\n    return Buffer.from(res);\n  }\n}\n\nexport class MACHeader {\n  static readonly spec = {\n    epoch: types.uint16be,\n    sequenceNumber: types.uint48be,\n    contentType: types.uint8,\n    protocolVersion: ProtocolVersion,\n    contentLen: types.uint16be,\n  };\n\n  constructor(\n    public epoch: number,\n    public sequenceNumber: number,\n    public contentType: number,\n    public protocolVersion: { major: number; minor: number },\n    public contentLen: number\n  ) {}\n\n  static createEmpty() {\n    return new MACHeader(\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any\n    );\n  }\n\n  static deSerialize(buf: Buffer) {\n    return new MACHeader(\n      //@ts-ignore\n      ...Object.values(decode(buf, MACHeader.spec))\n    );\n  }\n\n  serialize() {\n    const res = encode(this, MACHeader.spec).slice();\n    return Buffer.from(res);\n  }\n}\n"]}