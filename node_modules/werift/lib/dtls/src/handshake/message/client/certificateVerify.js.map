{"version":3,"file":"certificateVerify.js","sourceRoot":"","sources":["../../../../../../../dtls/src/handshake/message/client/certificateVerify.ts"],"names":[],"mappings":";;;AAAA,6CAAoD;AAGpD,+DAAuE;AAEvE,uCAA4C;AAE5C,MAAa,iBAAiB;IAS5B,YAAmB,SAA2B,EAAS,SAAiB;QAArD,cAAS,GAAT,SAAS,CAAkB;QAAS,cAAS,GAAT,SAAS,CAAQ;QARxE,YAAO,GAAG,qBAAa,CAAC,qBAAqB,CAAC;IAQ6B,CAAC;IAE5E,MAAM,CAAC,WAAW;QAChB,OAAO,IAAI,iBAAiB,CAAC,SAAgB,EAAE,SAAgB,CAAC,CAAC;IACnE,CAAC;IAED,MAAM,CAAC,WAAW,CAAC,GAAW;QAC5B,MAAM,GAAG,GAAG,oBAAM,CAAC,GAAG,EAAE,iBAAiB,CAAC,IAAI,CAAC,CAAC;QAChD,OAAO,IAAI,iBAAiB;QAC1B,YAAY;QACZ,GAAG,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,CACtB,CAAC;IACJ,CAAC;IAED,SAAS;QACP,MAAM,GAAG,GAAG,oBAAM,CAAC,IAAI,EAAE,iBAAiB,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,CAAC;QACzD,OAAO,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IAC1B,CAAC;IAED,UAAU;QACR,MAAM,IAAI,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;QAC9B,OAAO,IAAI,8BAAmB,CAC5B,IAAI,CAAC,OAAO,EACZ,IAAI,CAAC,MAAM,EACX,IAAI,CAAC,UAAW,EAChB,CAAC,EACD,IAAI,CAAC,MAAM,EACX,IAAI,CACL,CAAC;IACJ,CAAC;;AAtCH,8CAuCC;AAnCiB,sBAAI,GAAG;IACrB,SAAS,EAAE,mBAAK,CAAC,QAAQ;IACzB,SAAS,EAAE,mBAAK,CAAC,MAAM,CAAC,mBAAK,CAAC,QAAQ,CAAC;CACxC,CAAC","sourcesContent":["import { decode, encode, types } from \"binary-data\";\n\nimport { SignatureSchemes } from \"../../../cipher/const\";\nimport { FragmentedHandshake } from \"../../../record/message/fragment\";\nimport { Handshake } from \"../../../typings/domain\";\nimport { HandshakeType } from \"../../const\";\n\nexport class CertificateVerify implements Handshake {\n  msgType = HandshakeType.certificate_verify_15;\n  messageSeq?: number;\n\n  static readonly spec = {\n    algorithm: types.uint16be,\n    signature: types.buffer(types.uint16be),\n  };\n\n  constructor(public algorithm: SignatureSchemes, public signature: Buffer) {}\n\n  static createEmpty() {\n    return new CertificateVerify(undefined as any, undefined as any);\n  }\n\n  static deSerialize(buf: Buffer) {\n    const res = decode(buf, CertificateVerify.spec);\n    return new CertificateVerify(\n      //@ts-ignore\n      ...Object.values(res)\n    );\n  }\n\n  serialize() {\n    const res = encode(this, CertificateVerify.spec).slice();\n    return Buffer.from(res);\n  }\n\n  toFragment() {\n    const body = this.serialize();\n    return new FragmentedHandshake(\n      this.msgType,\n      body.length,\n      this.messageSeq!,\n      0,\n      body.length,\n      body\n    );\n  }\n}\n"]}