{"version":3,"file":"namedCurve.js","sourceRoot":"","sources":["../../../../../dtls/src/cipher/namedCurve.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA,uCAA8B;AAC9B,gDAAkC;AAElC,mCAAoE;AAQpE,SAAgB,eAAe,CAC7B,UAAgC;IAEhC,QAAQ,UAAU,EAAE;QAClB,KAAK,2BAAmB,CAAC,SAAS,CAAC,CAAC;YAClC,MAAM,QAAQ,GAAG,IAAI,aAAE,CAAC,MAAM,CAAC,CAAC;YAChC,MAAM,GAAG,GAAG,QAAQ,CAAC,UAAU,EAAE,CAAC;YAClC,MAAM,UAAU,GAAG,GAAG,CAAC,UAAU,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;YACnD,MAAM,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC,CAAC;YAEtE,OAAO;gBACL,KAAK,EAAE,UAAU;gBACjB,UAAU;gBACV,SAAS;aACV,CAAC;SACH;QACD,KAAK,2BAAmB,CAAC,MAAM,CAAC,CAAC;YAC/B,MAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC;YAEhC,OAAO;gBACL,KAAK,EAAE,UAAU;gBACjB,UAAU,EAAE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;gBAC9C,SAAS,EAAE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;aAC9C,CAAC;SACH;QACD;YACE,MAAM,IAAI,KAAK,EAAE,CAAC;KACrB;AACH,CAAC;AA5BD,0CA4BC","sourcesContent":["import { ec } from \"elliptic\";\nimport * as nacl from \"tweetnacl\";\n\nimport { NamedCurveAlgorithm, NamedCurveAlgorithms } from \"./const\";\n\nexport interface NamedCurveKeyPair {\n  curve: NamedCurveAlgorithms;\n  publicKey: Buffer;\n  privateKey: Buffer;\n}\n\nexport function generateKeyPair(\n  namedCurve: NamedCurveAlgorithms\n): NamedCurveKeyPair {\n  switch (namedCurve) {\n    case NamedCurveAlgorithm.secp256r1: {\n      const elliptic = new ec(\"p256\");\n      const key = elliptic.genKeyPair();\n      const privateKey = key.getPrivate().toBuffer(\"be\");\n      const publicKey = Buffer.from(key.getPublic().encode(\"array\", false));\n\n      return {\n        curve: namedCurve,\n        privateKey,\n        publicKey,\n      };\n    }\n    case NamedCurveAlgorithm.x25519: {\n      const keys = nacl.box.keyPair();\n\n      return {\n        curve: namedCurve,\n        privateKey: Buffer.from(keys.secretKey.buffer),\n        publicKey: Buffer.from(keys.publicKey.buffer),\n      };\n    }\n    default:\n      throw new Error();\n  }\n}\n"]}