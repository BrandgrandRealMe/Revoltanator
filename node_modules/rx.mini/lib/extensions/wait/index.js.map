{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../src/extensions/wait/index.ts"],"names":[],"mappings":";;;;;AAAA,+CAA2B;AAE3B,MAAqB,IAAI;IAGvB;QAFA;;;;mBAAiD,EAAE;WAAC;IAErC,CAAC;IAER,KAAK,CAAC,EAAU;QACtB,OAAO,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;IACnD,CAAC;IAED,MAAM,CAAC,GAAW;QAChB,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;IAC9B,CAAC;IAED,KAAK,CAAC,MAAM,CAAC,EAAU,EAAE,GAAqB;QAC5C,IAAI,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,EAAE;YAClB,OAAO,EAAE,KAAK,EAAE,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,EAAE,CAAC;SACvC;aAAM;YACL,MAAM,KAAK,GAAG,IAAI,WAAK,EAAK,CAAC;YAC7B,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC;YAE5B,MAAM,MAAM,GAAG,MAAM,GAAG,EAAE,CAAC;YAC3B,KAAK,CAAC,OAAO,CAAC,GAAG,MAAM,CAAC,CAAC;YACzB,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;YAEhB,OAAO,EAAE,MAAM,EAAE,CAAC;SACnB;IACH,CAAC;CACF;AA3BD,uBA2BC","sourcesContent":["import Event from \"../../\";\n\nexport default class Wait<T extends any[]> {\n  private candidates: { [id: string]: Event<T> } = {};\n\n  constructor() {}\n\n  private exist(id: string) {\n    return Object.keys(this.candidates).includes(id);\n  }\n\n  delete(kid: string) {\n    delete this.candidates[kid];\n  }\n\n  async create(id: string, job: () => Promise<T>) {\n    if (this.exist(id)) {\n      return { exist: this.candidates[id] };\n    } else {\n      const event = new Event<T>();\n      this.candidates[id] = event;\n\n      const result = await job();\n      event.execute(...result);\n      this.delete(id);\n\n      return { result };\n    }\n  }\n}\n"]}